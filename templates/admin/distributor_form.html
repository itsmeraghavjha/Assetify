{% extends "base.html" %}
{% block title %}{{ title }}{% endblock %}

{# This macro handles rendering our new SelectFields correctly #}
{% macro render_field(field, description=None) %}
  <div>
    {{ field.label(class="block text-sm font-medium text-gray-700 mb-1") }}
    
    {% if field.type == 'SelectField' %}
        {{ field(class="form-select" + (" border-red-500" if field.errors else "")) }}
    {% else %}
        {{ field(class="form-input" + (" border-red-500" if field.errors else "")) }}
    {% endif %}
    
    {% if description %}
      <p class="mt-1 text-xs text-gray-500">{{ description }}</p>
    {% endif %}

    {% if field.errors %}
      {% for error in field.errors %}
        <span class="text-xs text-red-600 font-medium">{{ error }}</span>
      {% endfor %}
    {% endif %}
  </div>
{% endmacro %}

{% block content %}
<div class="card max-w-4xl mx-auto page-content">
    <div class="card-header">
        <i class="fa fa-truck"></i> {{ title }}
    </div>
    <div class="card-content">
        <form action="" method="POST" novalidate>
            {{ form.hidden_tag() }}
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {{ render_field(form.name) }}
                {{ render_field(form.code) }}
                {{ render_field(form.city) }}
                {{ render_field(form.state) }}
            </div>
            
            <hr class="my-6 border-gray-200">
            
            <h3 class="text-lg font-medium text-gray-900 mb-4">Manager Assignments</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                {{ render_field(form.se_id) }}
                {{ render_field(form.bm_id) }}
                {{ render_field(form.rh_id) }}
            </div>

            <div class="mt-8 flex justify-end space-x-3">
                <a href="{{ url_for('manage_distributors') }}" class="btn btn-secondary">
                    Cancel
                </a>
                {{ form.submit(class="btn btn-main-action") }}
            </div>
        </form>
    </div>
</div>
{% endblock %}